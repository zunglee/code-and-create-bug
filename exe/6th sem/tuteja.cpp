#include<iostream>
#include<stdio.h>
//#include<conio.h>
#include<string.h>
using namespace std;
int a[1000001]={0};
void cal()
{
a[2]=1;
a[4]=1;
a[9]=1;
a[16]=1;
a[25]=1;
a[64]=1;
a[289]=1;
a[729]=1;
a[1681]=1;
a[2401]=1;
a[3481]=1;
a[4096]=1;
a[5041]=1;
a[7921]=1;
a[10201]=1;
a[15625]=1;
a[17161]=1;
a[27889]=1;
a[28561]=1;
a[29929]=1;
a[65536]=1;
a[83521]=1;
a[85849]=1;
a[146689]=1;
a[262144]=1;
a[279841]=1;
a[458329]=1;
a[491401]=1;
a[531441]=1;
a[552049]=1;
a[579121]=1;
a[597529]=1;
a[683929]=1;
a[703921]=1;
a[707281]=1;
a[734449]=1;
a[829921]=1;
for(int i=1;i<=1000000;i++)
a[i]+=a[i-1];
}
int main()
{
cal();
int t;
scanf("%d",&t);
for(int i=0;i<t;i++)
{
int c,d;
scanf("%d%d",&c,&d);
printf("%d\n",a[d]-a[c-1]);
}
// getch();
return 0;

}
